<div class="p-8 max-w-5xl mx-auto pt-20">
  <div
    *ngIf="toastMessage"
    class="app-toast"
    [ngClass]="[
      'show',
      toastType === 'success'
        ? 'app-toast--success'
        : toastType === 'info'
        ? 'app-toast--info'
        : 'app-toast--error'
    ]"
    [style.top.px]="toastOffset"
  >
    {{ toastMessage }}
  </div>
  <div class="flex justify-between items-center mb-8">
    <h2 class="text-3xl font-bold text-gray-800 m-0">Category Management</h2>
    <button class="px-4 py-2 border-none rounded-md font-medium cursor-pointer transition-all duration-200 text-sm bg-blue-500 text-white hover:bg-blue-600" (click)="openAddForm()">
      + Add Category
    </button>
  </div>

  <div class="bg-white rounded-lg shadow-sm overflow-hidden" *ngIf="categories.length > 0; else emptyState">
    <table class="w-full border-collapse">
      <thead class="bg-gray-50 border-b border-gray-200">
        <tr>
          <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide">Category</th>
          <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide">Description</th>
          <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide">Status</th>
          <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let category of categories" class="hover:bg-gray-50">
          <td class="px-4 py-4 border-b border-gray-100 text-sm">
            <div class="flex items-center gap-2 font-medium text-gray-900">
              <!-- <span class="text-xl">{{ category.icon }}</span> -->
              <span>{{ category.name }}</span>
            </div>
          </td>
          <td class="px-4 py-4 border-b border-gray-100 text-sm">{{ category.description || "No description" }}</td>
          <td class="px-4 py-4 border-b border-gray-100 text-sm">
            <span
              [class.bg-emerald-100]="category.isActive"
              [class.text-emerald-900]="category.isActive"
              [class.bg-red-100]="!category.isActive"
              [class.text-red-900]="!category.isActive"
              class="inline-block w-19 h-8 px-4 py-2 rounded-full text-xs text-center font-medium"
            >
              {{ category.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td class="px-4 py-4 border-b border-gray-100 text-sm">
            <div class="flex gap-2">
              <button
                class="px-5 py-2 text-xs bg-gray-500 text-white hover:bg-gray-600 border-none rounded-md font-medium cursor-pointer transition-all duration-200"
                (click)="openEditForm(category)"
                title="Edit category"
              >
                Edit
              </button>
              <button
                [class.bg-amber-500]="category.isActive"
                [class.hover:bg-amber-600]="category.isActive"
                [class.bg-emerald-500]="!category.isActive"
                [class.hover:bg-emerald-600]="!category.isActive"
                class="px-5 py-2 w-25 h-8 text-xs text-white border-none rounded-md font-medium cursor-pointer transition-all duration-200"
                (click)="toggleStatus(category)"
                title="Toggle status"
              >
                {{ category.isActive ? "Deactivate" : "Activate" }}
              </button>
              <button
                class="px-5 py-2  text-xs bg-red-500 text-white hover:bg-red-600 border-none rounded-md font-medium cursor-pointer transition-all duration-200"
                (click)="promptDelete(category)"
                title="Delete category"
              >
                Delete
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #emptyState>
    <div class="text-center p-16 bg-white rounded-lg shadow-sm">
      <p class="text-lg text-gray-500 my-2">ðŸ“‹ No categories found</p>
      <p class="text-sm text-gray-400">Click "Add Category" to create your first category</p>
    </div>
  </ng-template>

  <!-- Category Form Modal -->
  <div class="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50" *ngIf="showForm" (click)="closeForm()">
    <div class="bg-white rounded-lg max-w-2xl w-11/12 max-h-90vh overflow-y-auto" (click)="$event.stopPropagation()">
      <app-category-form
        [category]="editingCategory"
        (saved)="onFormSaved()"
        (cancelled)="closeForm()"
      ></app-category-form>
    </div>
  </div>

  <!-- Delete confirmation modal -->
  <div
    *ngIf="showDeleteConfirm"
    class="fixed inset-0 z-50 flex items-center justify-center p-4"
  >
    <div
      class="absolute inset-0 bg-black/50 backdrop-blur-sm"
      (click)="cancelDelete()"
    ></div>
    <div
      class="relative bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden border border-(--blue-100) animate-fade-in"
      (click)="$event.stopPropagation()"
    >
      <div class="absolute inset-x-0 top-0 h-1.5 bg-linear-to-r from-(--blue-400) via-(--blue-500) to-(--blue-600)"></div>
      <div class="p-6 sm:p-7">
        <div class="flex items-start gap-3">
          <div class="w-11 h-11 rounded-full bg-red-50 border border-red-100 flex items-center justify-center text-red-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v4m0 4h.01M5.07 6.93a10 10 0 1113.86 0L12 3 5.07 6.93z" />
            </svg>
          </div>
          <div class="space-y-1">
            <h3 class="text-xl font-bold text-gray-900">Delete category?</h3>
            <p class="text-gray-600 leading-relaxed">
              {{ categoryToDelete?.name || 'this category' }} will be removed permanently.
            </p>
          </div>
        </div>

        <div class="mt-6 flex flex-col sm:flex-row sm:justify-end gap-3">
          <button
            (click)="cancelDelete()"
            [disabled]="isDeleting"
            class="px-4 py-2.5 rounded-xl border border-gray-200 text-gray-700 font-semibold hover:bg-gray-50 transition-colors disabled:opacity-60"
          >
            Cancel
          </button>
          <button
            (click)="confirmDelete()"
            [disabled]="isDeleting"
            class="px-5 py-2.5 rounded-xl font-bold text-white bg-red-600 hover:bg-red-700 shadow-md transition-all disabled:opacity-60"
          >
            {{ isDeleting ? 'Deleting...' : 'Delete' }}
          </button>
        </div>
      </div>
    </div>
  </div>

</div>
