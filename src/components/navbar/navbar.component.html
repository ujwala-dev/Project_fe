<nav
  class="fixed top-0 left-0 w-full z-50 shadow-md flex items-center h-16 px-4 md:px-8"
  style="background-color: var(--blue-500); color: var(--blue-50)"
>
  <div class="flex items-center justify-between w-full max-w-7xl mx-auto">
    <!-- Logo -->
    <div class="text-2xl font-bold tracking-wide select-none">
      <a
        routerLink="/"
        class="hover:text-(--blue-200) transition-colors duration-200"
      >
        IdeaBoard
      </a>
    </div>

    <!-- Navigation Links -->
    <ul class="hidden md:flex items-center gap-8">
      <li *ngIf="isManager()">
        <a
          routerLink="/manager/dashboard"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Dashboard</a
        >
      </li>
      <li *ngIf="isManager()">
        <a
          routerLink="/manager/decision"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Decision</a
        >
      </li>

      <li *ngIf="isAdmin()">
        <a
          routerLink="/admin/dashboard"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Dashboard</a
        >
      </li>
      <li *ngIf="isAdmin()">
        <a
          routerLink="/admin/categories"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Categories</a
        >
      </li>
      <li *ngIf="isAdmin()">
        <a
          routerLink="/admin/manageusers"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Manage Users</a
        >
      </li>
      <li *ngIf="isAdmin()">
        <a
          routerLink="/admin/reports"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Reports</a
        >
      </li>

      <li *ngIf="isEmployee()">
        <a
          routerLink="/employee/dashboard"
          routerLinkActive="font-semibold text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Dashboard</a
        >
      </li>
      <li *ngIf="isEmployee()">
        <a
          routerLink="/employee/createidea"
          routerLinkActive="font-semibold text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Create Idea</a
        >
      </li>
      <li *ngIf="isEmployee()">
        <a
          routerLink="/employee/myideas"
          routerLinkActive="font-semibold text-white"
          [routerLinkActiveOptions]="{ exact: true }"
          class="text-(--blue-100) hover:text-white transition-colors"
          >My Ideas</a
        >
      </li>

      <!-- Fallback for generic roles -->
      <li *ngIf="!isEmployee() && !isManager() && !isAdmin()">
        <a
          routerLink="/employee/dashboard"
          routerLinkActive="font-semibold text-white"
          class="text-(--blue-100) hover:text-white transition-colors"
          >Dashboard</a
        >
      </li>
    </ul>

    <!-- User Profile / Login -->
    <div class="flex items-center gap-4">
      <!-- Notification Component (Only for Manager and Employee) -->
      <app-notification
        *ngIf="isLoggedIn() && (isManager() || isEmployee())"
      ></app-notification>

      <div
        class="relative"
        (click)="toggleDropdown()"
        data-dropdown-root
        *ngIf="isLoggedIn()"
      >
        <div
          class="w-10 h-10 flex items-center justify-center rounded-full font-bold cursor-pointer select-none transition-transform hover:scale-105 shadow-sm"
          style="background-color: var(--blue-300); color: var(--blue-500)"
          aria-haspopup="true"
          [attr.aria-expanded]="dropdownOpen()"
          [attr.title]="userName() || 'Profile'"
        >
          {{ userInitial() }}
        </div>

        <!-- Dropdown Menu -->
        <div
          *ngIf="dropdownOpen()"
          class="absolute right-0 mt-2 w-48 bg-white rounded shadow-xl border border-gray-100 py-1 text-gray-800 z-50 origin-top-right ring-1 ring-black/5"
          role="menu"
          aria-label="Profile Menu"
        >
          <div class="px-4 py-3 border-b border-gray-100 bg-(--blue-50)">
            <p
              class="text-xs font-semibold text-(--blue-400) uppercase tracking-wider"
            >
              Signed in as
            </p>
            <p class="text-sm font-medium truncate text-gray-900 mt-0.5">
              {{ userName() | uppercase }} - {{ userRole() }}
            </p>
          </div>
          <div class="border-t border-gray-100 my-1"></div>
          <button
            class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 font-medium"
            (click)="logout()"
            role="menuitem"
          >
            Sign out
          </button>
        </div>
      </div>

      <div *ngIf="!isLoggedIn()">
        <a
          routerLink="/"
          class="px-5 py-2 rounded font-medium shadow-sm transition-all hover:shadow-md hover:bg-(--blue-200)"
          style="background-color: var(--blue-300); color: var(--blue-500)"
        >
          Login
        </a>
      </div>
    </div>
  </div>
</nav>

<!-- Logout success toast -->
<div
  *ngIf="successMessage()"
  class="fixed inset-x-0 bottom-6 z-50 flex justify-center px-4 pointer-events-none"
>
  <div class="bg-emerald-500 text-white px-4 py-3 rounded-lg shadow-lg text-sm font-medium pointer-events-auto">
    {{ successMessage() }}
  </div>
</div>

<router-outlet></router-outlet>
